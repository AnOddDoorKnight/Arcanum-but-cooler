class InvulnerabilitySpell : ArcanumSpell
{
	override int GetIndex() { return 60; }
	override class<ArcanumSpellTree> GetTree() { return 'ArcanumTreeRestoration'; }
	override string GetName() { return "Invulnerability"; }
	override int GetSpellType() { return SType_SelfOrMass | SType_Targeted; }
	override int GetCatalystAmount() { return 2000; }
	override string GetDescription() { return "Grants temporary invulnerability that lasts 90 seconds.\n\n\c[Fire]Warning: will set everything on fire.\c-"; }
	override string GetTechnicalInfo() { return "Self, Targeted, Touch"; }
	override int GetMaxLevel() { return 1; }
	override int GetCost() { return 500; }
	override int GetAggroGain() { return 40; }
	override class<ArcanumSigil> GetSigil() { return 'InvulnerabilitySigil'; }
}

class InvulnerabilitySigil : ArcanumSigil
{
	override void ActivateTargeted()
	{
		let plr = HDPlayerPawn(AimTarget());
		if (plr && plr.Health > 0)
		{
			GiveInvulnerability(plr);
		}
	}

	override void ActivateSelfOrMass()
	{
		let plr = HDPlayerPawn(master);
		if (plr)
		{
			GiveInvulnerability(plr);
		}
	}

	private void GiveInvulnerability(HDPlayerPawn plr)
	{
		HDUPK Sphere = GreenSphere(Spawn("GreenSphere", plr.pos));
		Sphere.picktarget = plr;
		Sphere.A_HDUPKGive();
	}

	override void InitRuneSlots()
	{
		vector2 BigSize = (8, 13.33);
		CreateRuneSlot((-23, 0), BigSize, 2.25, 1.25);
		CreateRuneSlot((0, 23), BigSize, 2.25, 1.25);
		CreateRuneSlot((23, 0), BigSize, 2.25, 1.25);
		CreateRuneSlot((0, -23), BigSize, 2.25, 1.25);

		vector2 SmallSize = (6, 10);
		CreateRuneSlot((-41.1, 0), SmallSize, 1.3, 1.25);
		CreateRuneSlot((0, 41.1), SmallSize, 1.3, 1.25);
		CreateRuneSlot((41.1, 0), SmallSize, 1.3, 1.25);
		CreateRuneSlot((0, -41.1), SmallSize, 1.3, 1.25);
	}

	Default
	{
		Height 44;
		Radius 50;
		ArcanumSigil.FadeOutSpeedMult 3.0;
		StencilColor "11FF11";
	}

	States
	{
		Spawn:
			CRRE G 0;
			Goto Super::Spawn;
	}
}